<!DOCTYPE html>
<html lang="ko">

<head>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge">
  <meta name="viewport" content="width=device-width, initial-scale=2.0, maximum-scale=1.0, minimum-scale=1.0">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta name="keywords" content="e편한세상 강일 어반브릿지">
  <meta name="description" content="e편한세상 강일 어반브릿지">
  <meta name="robots" content="all">
  <meta property="og:url" content>
  <meta property="og:description" content="e편한세상 강일 어반브릿지">
  <meta property="og:title" content="e편한세상 강일 어반브릿지">

  <!-- 필수: babel -->
  <script src="//cdnjs.cloudflare.com/ajax/libs/babel-standalone/6.26.0/babel.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/babel-polyfill/7.12.1/polyfill.min.js"></script>
  <script src="https://unpkg.com/core-js-bundle@3.8.1/index.js"></script>
  <script src="https://unpkg.com/regenerator-runtime@0.13.7/runtime.js"></script>
  
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-CWKKRKF6NJ"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
  
    gtag('config', 'G-CWKKRKF6NJ');
  </script>

  <!-- Style include -->
  <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>

  <!-- library -->
  <link href="../css/owl.carousel.min.css" rel="stylesheet">
  <script src="../js/owl.carousel.min.js"></script>

  <!-- general style -->
  <link href="https://cdn.zipview.kr/public/fonts/common.css" rel="stylesheet">
  <link rel="stylesheet" type="text/css" href="../css/olim_general.css">
  <script src="../js/olim_general.js"></script>

  <!-- project -->
  <link rel="stylesheet" type="text/css" href="../css/sub_common.css">
  <script src="../js/sub_common.js"></script>

  <!-- 필수: VUE 삽입 -->
  <script src="https://cdn.jsdelivr.net/npm/vue@2.6.0"></script>

  <!-- 필수: VUE BASE TEMPLATE SCRIPT  -->
  <script src="//cdn.zipview.kr/cdms/engine/main.js"></script>

  <title>e편한세상 강일 어반브릿지</title>
</head>

<body>
  <div id="app" style="display: none">
    <!-- header -->
    <header class="header" id="header">
      <h1 class="ir_text">e편한세상 강일 어반브릿지</h1>
      <!-- sub 1depth -->
      <nav class="menu-wrap">
        <h2 class="ir_text">메뉴</h2>
        <div class="depth1_menu">
          <ul class="depth1_menu-list">
            <!-- 해당하는 메뉴에 is_selected 아이디 추가 / hashtag 연결이므로 다른 속성으로 변경 불가 -->
            <li class="depth1_menu-item" id="is_selected">
              <a href="img-ko.html"><span class="depth1_menu-title">세부정보</span></a>
            </li>
          </ul>
        </div>
      </nav>
      <!-- //sub 1depth -->
    </header>
    <!-- //header -->

    <!-- container -->
    <div class="container has_2depth">
      <!-- side_menu -->
      <aside class="side_menu">
        <nav class="side_menu-wrap">
          <h2 class="ir_text">소메뉴</h2>
          <div class="depth2_menu">
            <ul class="depth2_menu-list">
              <li class="depth2_menu-item" :class="{ is_active: selectMenu === item.menu.id }"
                v-for="(item, index) in items" :key="index">
                <button type="button" @click="changeMenu(item.menu.id)">
                  <span class="depth2_menu-title" v-text="item.menu.name"></span>
                </button>
              </li>
            </ul>
          </div>
        </nav>
      </aside>
      <!-- //side_menu -->

      <!-- contents/본문 -->
      <!-- [D] 이미지 비율에 따라 정사각형 비율에 가까우면 .video_cont에 is_square 클래스 추가/ 아닐경우 제거 -->
      <div v-if="selectItem" :class="['contents', 'video_cont', {'is_square': selectItem.img.isSquare}]">
        <div class="tabpanel_wrap">
          <div id="0" class="tabpanel">
            <!-- [D] 옵션 타이틀 -->
            <strong class="cont_title" v-text="selectItem.title"></strong>
            <div class="img_wrap">
              <!-- [D] 옵션 이미지, 1:1 비율 혹은 16:9 이미지가 들어갈 예정 -->
              <img :src="selectItem.img.url">
            </div>
            <!-- [D] 오리발 문구 -->
            <div class="cont_disc" v-if="selectItem.description">
              <pre class="disc_item" v-text="selectItem.description"></pre>
            </div>
          </div>
        </div>
      </div>
      <!-- //contents/본문 -->
    </div>
    <!-- //container -->
  </div>
</body>

</html>

<script type="text/babel" data-presets="es2015, stage-3">
  const vm = new Engine();
  vm.getContents().then(function () {
    new Vue({
      el: '#app',
      data: {
        vm,
        partner: vm.contents[0],
        selectMenu: '',
        items: [],
      },
      computed: {
        view() {
          return {
            menus: vm.getData('BNhJcIiikt', this.partner.id),
            titles: vm.getData('PcazVwTau2', this.partner.id),
            images: vm.getData('PU86TEqbgL', this.partner.id),
            description: vm.getData('qii5viRrtb', this.partner.id),
          };
        },
        selectItem() {
          return this.items.find(item => this.selectMenu === item.menu.id);
        }
      },
      created: async function () {
        document.getElementById('app').style.display = 'block';
        if (this.view.menus && this.view.menus.length) {
          await this.init();
        }
      },
      methods: {
        // computed -> view 가 가지고있는 3개의 데이터를 하나의 객체로 합쳐줌.
        init: async function () {
          // 이미지 가로세로 비율이 1:1 인경우 특정 클래스를 추가해주기 위한 Boolean 값.
          const getIsSquare = async (path) => {
            return new Promise((resolve) => {
              const img = new Image();
              img.src = path;
              img.onload = () => {
                resolve(img.width === img.height);
              }
              img.onerror = () => {
                resolve(false);
              }
            });
          }

          for (const [i, v] of this.view.menus.entries()) {
            this.items.push({
              menu: {
                id: v.id,
                name: v.data,
              },
              title: this.view.titles[i].data || '',
              img: {
                url: this.view.images[i].url || '',
                isSquare: await getIsSquare(this.view.images[i].url),
              },
              description: this.view.description[i].data || '',
            });
          }

          this.changeMenu(this.view.menus[0].id);
        },
        changeMenu: function (menuID) {
          this.selectMenu = menuID;
        }
      },
    });
  });
</script>